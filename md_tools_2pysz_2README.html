<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FZ Module Library: pysz</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">FZ Module Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">pysz</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md24"></a> Python bindings for <a class="el" href="namespaceSZ3.html">SZ3</a> - Error-bounded lossy compression for scientific data.</p>
<h1><a class="anchor" id="autotoc_md25"></a>
Overview</h1>
<p>pysz provides a clean Python interface to <a class="el" href="namespaceSZ3.html">SZ3</a>, a fast error-bounded lossy compressor for scientific data. Built with Cython 3.0+ for high performance.</p>
<h1><a class="anchor" id="autotoc_md26"></a>
Installation</h1>
<h2><a class="anchor" id="autotoc_md27"></a>
From PyPI (recommended)</h2>
<p><b>Pre-built binary wheels</b> are available for most platforms (Linux, macOS, Windows) and Python versions (3.8-3.13):</p>
<div class="fragment"><div class="line">pip install pysz</div>
</div><!-- fragment --><p>This is the easiest method - no build tools required! The binary wheels include everything you need.</p>
<h2><a class="anchor" id="autotoc_md28"></a>
Building from source</h2>
<p>If pre-built wheels aren't available for your platform, or if you want to build from source:</p>
<p><b>You need to first install the following tools:</b></p><ul>
<li><b>CMake ≥ 3.13</b></li>
<li><b>C++ compiler</b> (C++17-compatible: g++, clang++, MSVC)</li>
<li><b>Git</b></li>
<li><b>Python development headers</b> (python3-dev or python3-devel)</li>
</ul>
<p><b>Then build pysz from pip:</b> </p><div class="fragment"><div class="line">pip install pysz</div>
</div><!-- fragment --><p> <b>Or build pysz from source:</b> </p><div class="fragment"><div class="line">git clone https://github.com/szcompressor/SZ3.git</div>
<div class="line">cd SZ3/tools/pysz</div>
<div class="line">pip install -e .</div>
</div><!-- fragment --><p><b>What happens during source installation:</b></p><ol type="1">
<li><a class="el" href="namespaceSZ3.html">SZ3</a> is automatically downloaded from GitHub</li>
<li><a class="el" href="namespaceSZ3.html">SZ3</a> is built with CMake (zstd is bundled)</li>
<li>Python bindings are compiled against the built <a class="el" href="namespaceSZ3.html">SZ3</a></li>
<li>Everything is packaged together</li>
</ol>
<h1><a class="anchor" id="autotoc_md29"></a>
Quick Start</h1>
<div class="fragment"><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div>
<div class="line"><span class="keyword">from</span> pysz <span class="keyword">import</span> sz, szConfig, szErrorBoundMode, szAlgorithm</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create test data</span></div>
<div class="line">data = np.random.rand(8, 8, 128).astype(np.float32)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create config</span></div>
<div class="line">config = szConfig()</div>
<div class="line">config.errorBoundMode = szErrorBoundMode.ABS</div>
<div class="line">config.absErrorBound = 1e-3</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Compress</span></div>
<div class="line">compressed, ratio = sz.compress(data, config)</div>
<div class="line">print(f<span class="stringliteral">&quot;Compression ratio: {ratio:.2f}x&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Decompress</span></div>
<div class="line">decompressed, config = sz.decompress(compressed, np.float32, data.shape)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Verify</span></div>
<div class="line">max_err, psnr, nrmse = sz.verify(data, decompressed)</div>
<div class="line">print(f<span class="stringliteral">&quot;Max error: {max_err:.2e}, PSNR: {psnr:.2f} dB, NRMSE: {nrmse:.2e}&quot;</span>)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md30"></a>
API Reference</h1>
<h2><a class="anchor" id="autotoc_md31"></a>
szConfig Class</h2>
<p>Configuration object for <a class="el" href="namespaceSZ3.html">SZ3</a> compression. It mirrors the C++ <code>Config</code> class. During compression, the dimensions are automatically inferred from the numpy array shape, so you don't need setup the config dimensions.</p>
<h2><a class="anchor" id="autotoc_md32"></a>
sz.compress()</h2>
<div class="fragment"><div class="line">sz.compress(data, config) -&gt; (compressed, ratio)</div>
</div><!-- fragment --><p>Compress a NumPy array. Dimensions are automatically inferred from data shape.</p>
<p><b>Parameters:</b></p><ul>
<li><code>data</code> (ndarray): NumPy array (float32, float64, int32, or int64)</li>
<li><code>config</code> (szConfig): Config object</li>
</ul>
<p><b>Returns:</b></p><ul>
<li><code>compressed</code> (ndarray): Compressed data as uint8 array</li>
<li><code>ratio</code> (float): Compression ratio (original_size / compressed_size)</li>
</ul>
<h2><a class="anchor" id="autotoc_md33"></a>
sz.decompress()</h2>
<div class="fragment"><div class="line">sz.decompress(compressed, dtype, shape) -&gt; (data, config)</div>
</div><!-- fragment --><p>Decompress data back to NumPy array.</p>
<p><b>Parameters:</b></p><ul>
<li><code>compressed</code> (ndarray): Compressed uint8 array from <code>compress()</code></li>
<li><code>dtype</code> (type): NumPy dtype (np.float32, np.float64, np.int32, or np.int64)</li>
<li><code>shape</code> (tuple): Shape of the original data</li>
</ul>
<p><b>Returns:</b></p><ul>
<li><code>data</code> (ndarray): Decompressed data with the specified shape</li>
<li><code>config</code> (szConfig): Config object used for decompression</li>
</ul>
<h2><a class="anchor" id="autotoc_md34"></a>
sz.verify()</h2>
<div class="fragment"><div class="line">sz.verify(src_data, dec_data) -&gt; (max_diff, psnr, nrmse)</div>
</div><!-- fragment --><p>Compare decompressed data with original data and calculate quality metrics.</p>
<p><b>Parameters:</b></p><ul>
<li><code>src_data</code> (ndarray): Original data before compression</li>
<li><code>dec_data</code> (ndarray): Decompressed data to verify</li>
</ul>
<p><b>Returns:</b></p><ul>
<li><code>max_diff</code> (float): Maximum absolute difference</li>
<li><code>psnr</code> (float): Peak Signal-to-Noise Ratio in dB</li>
<li><code>nrmse</code> (float): Normalized Root Mean Square Error</li>
</ul>
<p><b>Example:</b> </p><div class="fragment"><div class="line">&gt;&gt;&gt; max_err, psnr, nrmse = sz.verify(data, decompressed)</div>
<div class="line">&gt;&gt;&gt; print(f<span class="stringliteral">&quot;Max error: {max_err:.2e}, PSNR: {psnr:.2f} dB&quot;</span>)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md35"></a>
Usage Examples</h1>
<h2><a class="anchor" id="autotoc_md36"></a>
Basic Usage</h2>
<div class="fragment"><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div>
<div class="line"><span class="keyword">from</span> pysz <span class="keyword">import</span> sz, szConfig, szErrorBoundMode, szAlgorithm</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create data</span></div>
<div class="line">data = np.random.randn(100, 200, 300).astype(np.float32)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Create config</span></div>
<div class="line">config = szConfig()</div>
<div class="line">config.errorBoundMode = szErrorBoundMode.ABS</div>
<div class="line">config.absErrorBound = 1e-3</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Compress</span></div>
<div class="line">compressed, ratio = sz.compress(data, config)</div>
<div class="line">print(f<span class="stringliteral">&quot;Compressed {data.nbytes} → {compressed.size} bytes ({ratio:.2f}x)&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Decompress - returns (data, config)</span></div>
<div class="line">decompressed, dec_config = sz.decompress(compressed, np.float32, data.shape)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Verify quality</span></div>
<div class="line">max_err, psnr, nrmse = sz.verify(data, decompressed)</div>
<div class="line">print(f<span class="stringliteral">&quot;Max error: {max_err:.2e}, PSNR: {psnr:.2f} dB, NRMSE: {nrmse:.2e}&quot;</span>)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md37"></a>
Loading from Config File (Optional)</h2>
<div class="fragment"><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div>
<div class="line"><span class="keyword">from</span> pysz <span class="keyword">import</span> sz, szConfig</div>
<div class="line"> </div>
<div class="line">data = np.fromfile(<span class="stringliteral">&#39;testdata.dat&#39;</span>, dtype=np.float32).reshape(8, 8, 128)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Load config from file</span></div>
<div class="line">config = szConfig()</div>
<div class="line">config.loadcfg(<span class="stringliteral">&#39;sz3.config&#39;</span>)</div>
<div class="line">compressed, ratio = sz.compress(data, config)</div>
<div class="line">decompressed, _ = sz.decompress(compressed, np.float32, data.shape)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md38"></a>
Relative Error Bound</h2>
<div class="fragment"><div class="line"><span class="keyword">from</span> pysz <span class="keyword">import</span> szConfig, szErrorBoundMode</div>
<div class="line"> </div>
<div class="line">config = szConfig()</div>
<div class="line">config.errorBoundMode = szErrorBoundMode.REL</div>
<div class="line">config.relErrorBound = 1e-4  <span class="comment"># 0.01% relative error</span></div>
<div class="line">compressed, ratio = sz.compress(data, config)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md39"></a>
Different Algorithms</h2>
<div class="fragment"><div class="line"><span class="keyword">from</span> pysz <span class="keyword">import</span> szConfig, szErrorBoundMode, szAlgorithm</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Default: INTERP_LORENZO (best quality)</span></div>
<div class="line">config = szConfig()</div>
<div class="line">config.errorBoundMode = szErrorBoundMode.ABS</div>
<div class="line">config.absErrorBound = 1e-3</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Or try other algorithms</span></div>
<div class="line">config.cmprAlgo = szAlgorithm.INTERP        <span class="comment"># Interpolation only</span></div>
<div class="line">config.cmprAlgo = szAlgorithm.LORENZO_REG   <span class="comment"># Lorenzo/regression</span></div>
<div class="line">config.cmprAlgo = szAlgorithm.LOSSLESS      <span class="comment"># Lossless only</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md40"></a>
Double Precision</h2>
<div class="fragment"><div class="line">data_double = np.random.randn(50, 50, 50).astype(np.float64)</div>
<div class="line">config = szConfig()</div>
<div class="line">config.errorBoundMode = szErrorBoundMode.ABS</div>
<div class="line">config.absErrorBound = 1e-6</div>
<div class="line">compressed, ratio = sz.compress(data_double, config)</div>
<div class="line">decompressed, _ = sz.decompress(compressed, np.float64, data_double.shape)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md41"></a>
Save/Load Compressed Data</h2>
<div class="fragment"><div class="line"><span class="comment"># Compress and save</span></div>
<div class="line">compressed, ratio = sz.compress(data, config)</div>
<div class="line">compressed.tofile(<span class="stringliteral">&#39;data.sz&#39;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Later: load and decompress</span></div>
<div class="line">compressed = np.fromfile(<span class="stringliteral">&#39;data.sz&#39;</span>, dtype=np.uint8)</div>
<div class="line">decompressed, _ = sz.decompress(compressed, np.float32, (8, 8, 128))</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md42"></a>
Troubleshooting</h1>
<h2><a class="anchor" id="autotoc_md43"></a>
Import Error</h2>
<div class="fragment"><div class="line">ImportError: cannot import name &#39;sz&#39; from &#39;pysz&#39;</div>
</div><!-- fragment --><p><b>Solution:</b> </p><div class="fragment"><div class="line">cd tools/pysz</div>
<div class="line">pip install -e .</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md44"></a>
Library Not Found (Linux)</h2>
<div class="fragment"><div class="line">OSError: libzstd.so: cannot open shared object file</div>
</div><!-- fragment --><p><b>Solution:</b> </p><div class="fragment"><div class="line">export LD_LIBRARY_PATH=&quot;../../build/tools/zstd:$LD_LIBRARY_PATH&quot;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md45"></a>
Links</h1>
<ul>
<li><b>Repository:</b> <a href="https://github.com/szcompressor/SZ3">https://github.com/szcompressor/SZ3</a></li>
<li><b>Issues:</b> <a href="https://github.com/szcompressor/SZ3/issues">https://github.com/szcompressor/SZ3/issues</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md46"></a>
License</h1>
<p>See <code>../../copyright-and-BSD-license.txt</code> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
